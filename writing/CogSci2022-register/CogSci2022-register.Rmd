---
title: "Title TBD"
bibliography: CogSci2022-register.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: > 
    \author{{\large \bf Kennedy Casey} \\ University of Chicago \\ \texttt{kbcasey@uchicago.edu}
    \And {\large \bf Marisa Casillas} \\ University of Chicago \\ \texttt{mcasillas@uchicago.edu}}

abstract: >
  Child-directed speech (CDS) features words such as _doggy_, *night-night*, and _tummy_ that are rarely used in adult-directed speech (ADS). Characterisitcs of CDS word forms, such as reduplication and diminutivization, explain why they may be learned and produced earlier by children. However, it is not yet clear how or when children switch to using ADS equivalentsâ€”--*dog*, _goodnight_, _stomach_. Through analysis of transcripts from CHILDES and the Language Development Project corpus, we show that children significantly increase their production of ADS word forms across age, with the average CDS-to-ADS transition point at 2.5 years. Many of the linguistic features that distinguish CDS vs. ADS registers (e.g., speech rate, lexical complexity, etc.) similarly differentiate the local speech contexts surrounding CDS vs. ADS word forms. To test whether these patterns in children's input...classifier details...Learners may therefore be able to capitalize on these cues to support their discovery of context-appropriate CDS/ADS pair use.
  
keywords: >
    child-directed speech; word production; linguistic input; social register; corpus analysis; developmental change
    
output: cogsci2016::cogsci_paper
final-submission: \cogscifinalcopy
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width = 3, fig.height = 3, fig.crop = F, 
                      fig.pos = "tb", fig.path = 'figs/',
                      echo = F, warning = F, cache = F, 
                      message = F, sanitize = T)
```

```{r, libraries}
library(png)
library(grid)
library(xtable)
library(kableExtra)
library(tidyverse)
library(ggpubr)
library(DescTools)

# source(data-prep/overall/get_freq.R)
metadata <- read_csv("../../data-prep/overall/metadata.csv")
freq <- read_csv("../../data-prep/overall/freq.csv")

cds_forms <- read_csv("../../data-prep/overall/item-info.csv") %>%
    filter(form == "CDS") %>%
    pull(word)

ads_forms <- read_csv("../../data-prep/overall/item-info.csv") %>%
    filter(form == "ADS") %>%
    pull(word)

input_colors <- c("prosodic" = "#1C9E78", 
                  "lexical" = "#D95F06", 
                  "syntactic" = "#7570B4")
```

# Introduction
Across many cultures and languages, speech that is addressed to children sounds remarkably different from speech that is addressed to adults (REFs). When communicating with young children, adults (and even older children; REFS) often modify their speech in ways that draw children's attention and support their several aspects of their language learning [e.g., @nencheva2021moment; @rowe2008child; @shneidman2012language; @weisleder2013talking]. As a result, child-directed speech (CDS) is differentiated from adult-directed speech (ADS) at multiple linguistic levels, including prosodic, lexical, and syntactic [@soderstrom2007beyond].

## Linguistic features of child-directed speech
CDS is associated with higher overall pitch as well as greater variability in pitch contours [@fernald1989intonation; @vosoughi2012longitudinal]. Vowels (REF) and words (REF) in CDS are often lengthened, creating utterances that are produced more slowly (REF) and that also include more pauses (REF). At the lexical level, CDS typically includes more repetition [@henning2005maternal], more words that children already know [@foushee2016lexical], and many register-specific words (e.g., in English, _doggy_, *night-night*, and _tummy_, REFS). Syntactically, CDS is characterized as less complex than ADS. CDS utterances are typically shorter (REF) and feature simpler constructions (check and REF). <!--kc: maybe something here about CDS being typed as a more simplified register but that's not necessarily the case. more phonetic variability, something else, and seemingly redundant lexical items. the focus of the current investigation is this last point-->

[connecting sentence here]. Even very young infants appear to pick up on differences between CDS and ADS, as evidenced by their reliable preference for listening to CDS over ADS [@cooper1990preference; @manybabies2020quantifying]. In addition to this overall preference for CDS, accumulating evidence points to children's ability to distinguish individual linguistic features (REFS).

## Social context of child-directed speech
<!--kc: maybe a note here about other distinctions (e.g., acoustic and interactional). ep's paper on timbre and more about the social, oftentimes dyadic, context--> Linguistic cues are not the only distinguishing features between CDS and ADS. For instance...examples like acoustic, maybe affective (if there's a ref that separates this from prosodic), and, most notably, social [@golinkoff2015baby]. BLABLABLA kids are linking linguistic and social information. Infants as young as 12 to 20 months show an emerging understanding of the relationship between registers and addressees [@soley2020infants; @ikeda2018sensitivity]. Put simply, CDS should be directed to young children, not adults [possibly a few other examples here]

## The current study
Here, we focus on the question of whether children may also be able to learn more subtle associations between words and registers. <!--kc: need to be careful here because we don't have data to fully speak to kids' understanding--> We return to examination of a specific lexical modification of CDS: the inclusion of register-specific words. [add stuff about why 2 labels initally seem counterintuitive but then characteristics of CDS forms that explain away the learnability issue]. Existing research does well to provide evidence for why CDS forms make up a large proportion of directed input and why they may be learned and produced earlier by children. However, conventions of adult speech <!--kc: definitely need a better phrase here--> require children to eventually transition to using ADS forms---a learning problem that has not yet received empirical attention. [connecting sentence here] <!--kc: something about the focus on lots of lang dev research on increasing vocabulary size but not necessarily context-appropriate usage or the 'loss' of words in a way-->

First, we analyze existing speech corpora for children up to age 7 to determine if and when we can detect a shift from CDS to ADS vocabulary [explain what we mean by this]. After establishing that a shift towards production of ADS forms (over CDS forms) occurs in early childhood, we next explore what information in children's linguistic input could support this shift. We investigate whether many of the linguistic features that distinguish _between_ CDS and ADS at the register level also differentiate CDS and ADS words at the utterance level. <!--kc: wording needs work here but the point that we're mostly looking at CDS is crucial--> [classifier details here].

<!--
overview of previous work, which has largely focused on the learnability question or why these words appear in the first place
seemingly a challenge for word learners that now have to make 2 form mappings to the same meaning but diminutive suffix as a decently reliable cue to word ending [@kempe2005diminutives] 
diminutivization and reduplication predictive of learning [@ota2018choo]
existing research does well to account for why CDS forms make up a large proportion of the input and why they are learned and produced earlier by children
however, 'conventional'  (definitely need a better word here) word usage requires them to eventually transition to using ADS forms- a problem that has not yet been addressed

from there, we sought to determine which regularities might be sufficient to allow children to learn the appropriate distinctions between usage contexts for CDS vs. ADS forms

Ideas that don't really have a place yet:
mutual exclusivity--seems more tangential right now but could serve as motivation for wanting to study these words, in particular
dev changes in other input measures (e.g., overall rates of CDS, other word usage, etc.)--could motivate the longitudinal look we take here
fine-tuned input--probably not relevant unless we look at adult shifts from CDS to ADS too, later on can look at changes in the input near the transition point

CDS feature refs:
[@spinelli2017prosody]

Multiple label refs:
[@clark1987principle]

Social refs:
[@kinzler2009accent]
[@weatherhead2021toddlers]
[@weatherhead2021putting]: ME is about social inference
[@ramirez-esparza2014look]: CDS helps word learning but it's also about the social context (dyadic interaction)

Dev change/fine tuning refs:
[@ramirez-esparza2017look]: similar ideas to above but longitudinal
[@bergelson2019north]: increase in prop CDS over the first 20 months, driven by a decrease in ODS
[@jiangURexploring]: distributional semantics
[@odijk2020fine]: MLU decreasing before child word production
[@tippenhauer2020scope]: less rep reduction of low-frequency words in CDS
-->

# Method

## Corpora

We analyzed `r metadata$n_transcripts` transcripts in the North American English collection of the Child Language Data Exchange System (CHILDES) database [@macwhinney2000childes]. The included transcripts were drawn from `r metadata$n_corpora` individual corpora and featured `r metadata$n_kids` children up to 7 years of age (range = `r metadata$min_age`--`r metadata$max_age` months, _M_ = `r metadata$mean_age` months). 

Data from the Language Development Project (LDP) longitudinal corpus were also analyzed <!--kc: figure out how to properly cite-->. These included XX transcripts from XX children recorded every 4 months for approximately one hour from age 14 to 58 months.

## Target words
Fifteen CDS/ADS word pairs (30 total target words) were selected based on the appearance of at least one form on the MacArthur-Bates Communicative Development Inventory [@fenson1994variability] and their frequency of occurrence in CHILDES (at least 100 child-produced tokens and 100 other-produced tokens per form; see Table \ref{tab:tab1}). Test items were chosen such that the same object, animal, or routine could be reasonably labeled with either form in the pair in typical communicative interactions with young children (e.g., _doggy_ or _dog_).

```{r freq_table, results = "asis"}
cds_freq <- freq %>%
    filter(word %in% cds_forms)

ads_freq <- freq %>%
    filter(word %in% ads_forms)

freq <- bind_cols(cds_freq, ads_freq) %>%
    mutate(pair = paste0(word...1, '/', word...4)) %>%
    select(pair, child...2, other...3, child...5, other...6) 
colnames(freq) <- c("Pair", "Child", "Other", "Child", "Other")

xtable::xtable(freq, digits = 0,
                             include.rownames = FALSE, 
                             label = "tab:tab1",
                             caption = "CHILDES frequency for 15 CDS/ADS word pairs. Child-produced
                             counts include tokens produced only by the target child. All other 
                             speakers' productions are included in the other-produced counts.") %>%
    xtable2kable(booktabs = TRUE, escape = FALSE) %>%
    kable_styling(latex_options = "scale_down") %>%
    add_header_above(c(" " = 2, "CDS tokens by speaker" = 2, "ADS tokens by speaker" = 2), bold = TRUE) %>%
    row_spec(0, bold = TRUE) %>%
    column_spec(2, italic = TRUE)

#print(freq_table, include.rownames = FALSE,
      #type = "latex", comment = FALSE, table.placement = "!hb")
```

## Linguistic predictors

All analyses were conducted over individual utterances. We quantified prosodic, lexical, and syntactic information to describe each utterance containing one of the 30 target words.

### Prosodic level
We measured three types of prosodic information: mean pitch (Hz), pitch range (Hz), and speaking rate (words per second). These measures were calculated over all timestamped utterances in CHILDES (`r metadata$child_timestamped`% of child-produced and `r metadata$other_timestamped`% of other-produced utterances). Utterances shorter than 58 ms were excluded from analysis. This lower bound was set by identifying the the shortest possible duration of an utterance containing at least one word in four manually annotated North American English corpora in HomeBank [@homebank; @bergelsoncorpus; @soderstromcorpus; @vandamcorpus; @warlaumontcorpus]. Pitch information was extracted using Praat software [@boersma2016praat].

### Lexical level
We measured two types of lexical information: complexity and rarity. Lexical complexity was defined as the negative log proportion of known words in each utterance [consistent with @foushee2016lexical; @kidd2012goldilocks]. A word was considered 'known' if the age of acquisition (AoA) estimate [@fenson1994variability; @frank2017wordbank] was less than or equal to the age of the target child when they heard or produced the utterance. Utterances with proportionally fewer known words are more lexically complex. Lexical rarity was determined based on overall frequency in CHILDES. For all words with at least XX tokens^[Manual checks revealed that many or XX% of the lowest-frequency words included idiosyncratic or erroneous transcriptions and/or repetitions of children's babbling.], we calculated a rarity score as the negative log proportion of other-produced tokens in CHILDES (i.e., number of tokens for a given word/sum of all tokens in the full corpus), and then averaged for rarity scores for all target utterances. Utterances with more low-frequency words are considered more lexically rare. \newline

### Syntactic level
Syntactic measures included both the length of the utterance (in words) and the number of verb phrases. The number of words per utterance was automatically extracted using the `childesr` package [@braginsky2021childesr]. The number of verb phrases per utterance was determined using `spaCy3`, an automatic syntactic parser [@honnibal2020spacy].

# Results

## Measuring production: When do children produce CDS vs. ADS forms?
```{r}
# read in lmer outputs generated in shift-timing.R 
overall.shift <- read_csv("../../analysis/model-outputs/shift-timing.csv")
```
We first asked when CDS forms are replaced by ADS forms in children's own speech. We fit a mixed-effects binomial logistic regression model predicting children's production of CDS vs. ADS forms, with target child age (in months, scaled) as a single fixed effect. Random slopes and intercepts for word pairs were also included. For target word token, the form was coded as 0 (CDS) or 1 (ADS). All tokens were considered, even if there were multiple repetitions of the same word or variations in form within the same utterance. <!--kc: can drop these details if needed space-wise but i think this question might come up--> Thus, the model captures, for each age, the relative proportion of CDS vs. ADS forms in children's own speech.

Children's production of ADS forms increased across age ($\beta$ = `r format(round(overall.shift$estimate, 2), 2)`, _SE_ = `r format(round(overall.shift$std.error, 2), 2)`, _t_ = `r format(round(overall.shift$statistic, 2), 2)`, _p_ `r ifelse(overall.shift$p.value < .001, paste("< 0.001"), paste("=", format(round(overall.shift$p.value, 3), 3)))`; Figure 1). That is, with increasing age, children increasingly produced ADS forms over CDS forms. The average CDS-to-ADS transition point across all words (i.e., the point at which ADS forms were produced >50% of the time) was around 2.5 years of age. <!--kc: determine years vs. months and stay consistent in reporting throughout-->

```{r shift-timing-fig, fig.env = "figure", fig.pos = "!h", fig.align = "center", fig.width = 2.9, fig.height = 2.9, fig.cap = "Model-predicted increase in production of ADS forms with age. Gray lines depict raw individual word-pair trajectories."}

shift.timing <- png::readPNG("../figs/shift-timing.png")
grid::grid.raster(shift.timing)
```

Analyses of individual word-pair trajectories revealed...[add summary of individual models, i.e., XX of 15 pairs showed significant increase in ADS with age PLUS description of different shift types]

```{r shift-timing-bypair-fig, fig.env = "figure", fig.pos = "!h", fig.align = "center", fig.width = 3.4, fig.height = 5, fig.cap = "Inidividual word-pair trajectories for increasing ADS forms (blue) and descreasing CDS forms (red) with age. Columns indicate categorically different shift trajectory types (i.e., items where the ADS form appears dominant from the start, items where CDS forms are replaced by ADS forms early on, and items where ADS forms become dominant later in development."}

bypair.shift.timing <- png::readPNG("../figs/bypair-shift-timing.png")
grid::grid.raster(bypair.shift.timing)
```


## Characterizing the input: In what linguistic contexts do children hear CDS vs. ADS forms?

We used mixed-effects binomial logistic regression models to predict the appearance of CDS vs. ADS forms in given utterance on the basis of target child's age, several linguistic properties of the utterance, and interactions between each property and age. Models included random slopes and intercepts for individual word pairs and speakers and were fitted to all utterance data from speakers other than the target child.

Main effects and interactions with age are shown in Figure 2.

```{r model-plot, fig.env = "figure", fig.pos = "H", fig.align = "center", fig.width = 3.4, fig.height = 4.4, fig.cap = "Coefficient estimates for linguistic predictors of form. Positive main effects indicate that utterances are more likely to contain ADS forms when they have higher values for the predictor (e.g., faster speech rates). Positive age interactions indicate an increasing effect of the predictor with age. Error bars depict standard errors of the coefficient estimates, and filled circles represent significant effects (\\textit{p} $<$ 0.05)."}

path_to_models <- "../../analysis/model-outputs/other-utts/"
model_filenames <- list.files(path = path_to_models, pattern = "*.csv")
model_files <- lapply(paste0(path_to_models, model_filenames), read_csv)
model_info <- bind_rows(model_files, .id = "source") %>%
  group_by(source) %>%
  mutate(order = row_number(), 
         type = case_when(
           order == 1 ~ "intercept", 
           order == 2 ~ "main_effect", 
           order == 3 ~ "age", 
           order == 4 ~ "interaction"), 
         Sig = ifelse(p < .05, "sig", "not_sig"), 
         Predictor = StrCap(str_replace(str_remove_all(Predictor, "_scaled"), "_", " "), "first"), 
         level = ifelse(str_detect(Predictor, "MLUw|MLUm|Verbs"), "syntactic", 
                        ifelse(str_detect(Predictor, "Complexity|Freq"), "lexical", "prosodic"))) %>%
  filter(!str_detect(Predictor, "MLUm")) %>%
  mutate(Predictor = factor(Predictor, levels = c("Freq", "Freq:age", "Complexity", "Complexity:age", "Verbs", "Verbs:age", "MLUw", "MLUw:age", "Speech rate", "Speech rate:age", "Pitch range", "Pitch range:age", "Pitch mean", "Pitch mean:age")))

main_effects <- ggplot(filter(model_info, type == "main_effect"), 
       aes(x = Estimate, y = Predictor, color = level)) +
  geom_vline(xintercept = 0, size = 0.2, linetype = "dotted", 
             color = "gray", alpha = 0.5) +
  geom_errorbar(aes(xmin = Estimate - SE, xmax = Estimate + SE), 
                width = 0, size = 0.25) + 
  geom_point(aes(shape = Sig), size = 0.75) +
  scale_shape_manual(values = c(21, 19)) +
  scale_color_manual(values = input_colors) +
  scale_x_continuous(limits = c(-0.4, 0.4)) +
  labs(title = "Main Effect", x = "Coefficient Estimate") +
  theme_test(base_size = 5) +
  theme(legend.position = "None", plot.title = element_text(hjust = 0.5))
  
interactions <- ggplot(filter(model_info, type == "interaction"), 
       aes(x = Estimate, y = Predictor, color = level)) +
  geom_vline(xintercept = 0, size = 0.2, linetype = "dotted", 
             color = "gray", alpha = 0.5) +
  geom_errorbar(aes(xmin = Estimate - SE, xmax = Estimate + SE), 
                width = 0, size = 0.25) + 
  geom_point(aes(shape = Sig), size = 0.75) +
  scale_shape_manual(values = c(21, 19)) +
  scale_color_manual(values = input_colors) +
  scale_x_continuous(limits = c(-0.4, 0.4)) +
  labs(title = "Interaction with Age", x = "Coefficient Estimate") +
  theme_test(base_size = 5) +
  theme(legend.position = "None", plot.title = element_text(hjust = 0.5), 
        axis.text.y = element_blank(), axis.title.y = element_blank(), 
        axis.ticks.y = element_blank())

model_fig <- ggarrange(main_effects, interactions, widths = c(2, 1.5))
ggsave("../figs/model-outputs.png", model_fig, height = 2, width = 3, dpi = 300)

img <- png::readPNG("../figs/model-outputs.png")
grid::grid.raster(img)
```

## Modeling learning: What linguistic information is most useful for distinguishing CDS vs. ADS contexts?

# Discussion

<!--
# Acknowledgements
Research reported in this publication was supported by the Eunice Kennedy Shriver National Institute of Child Health & Human Development of the National Institutes of Health under Award Number P01HD040605; by a grant from the Successful Pathways from School to Work initiative of the University of Chicago, funded by the Hymen Milgrom Supporting Organization; by a grant from the Institute of Education Sciences, U.S. Department of Education, through grant R305A190467 to the University of Chicago; and by a grant from the Spencer Foundation. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health, the Institute of Education Sciences, or the U.S. Department of Education.
-->

# References

```{r}
# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```

\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent